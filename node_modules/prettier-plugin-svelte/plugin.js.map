{"version":3,"file":"plugin.js","sources":["src/print/helpers.ts","src/lib/extractAttributes.ts","src/lib/getText.ts","src/options.ts","src/lib/snipTagContent.ts","src/print/index.ts","src/embed.ts","src/index.ts"],"sourcesContent":["import { Node, ScriptNode, InstanceScriptNode, ModuleScriptNode } from './nodes';\r\n\r\nexport interface ASTNode {\r\n    html: Node;\r\n    css?: Node & {\r\n        attributes: Node[];\r\n        children: Node[];\r\n        content: Node & {\r\n            styles: string;\r\n        };\r\n    };\r\n    js?: ScriptNode;\r\n    instance?: ScriptNode;\r\n    module?: ScriptNode;\r\n}\r\n\r\nexport function isASTNode(n: any): n is ASTNode {\r\n    return 'html' in n && 'tokens' in n;\r\n}\r\n","import { AttributeNode, TextNode } from '../print/nodes';\r\n\r\nexport function extractAttributes(html: string): AttributeNode[] {\r\n    const extractAttributesRegex = /<[a-z]+\\s*(.*?)>/i;\r\n    const attributeRegex = /([^\\s=]+)(?:=(\"|')(.*?)\\2)?/gi;\r\n\r\n    const [, attributesString] = html.match(extractAttributesRegex)!;\r\n\r\n    const attrs: AttributeNode[] = [];\r\n\r\n    let match: RegExpMatchArray | null;\r\n    while ((match = attributeRegex.exec(attributesString))) {\r\n        const [all, name, quotes, value] = match;\r\n        const attrStart = match.index!;\r\n\r\n        let valueNode: AttributeNode['value'];\r\n        if (!value) {\r\n            valueNode = true;\r\n        } else {\r\n            let valueStart = attrStart + name.length;\r\n            if (quotes) {\r\n                valueStart += 2;\r\n            }\r\n\r\n            valueNode = [\r\n                {\r\n                    type: 'Text',\r\n                    data: value,\r\n                    start: valueStart,\r\n                    end: valueStart + value.length,\r\n                } as TextNode,\r\n            ];\r\n        }\r\n\r\n        attrs.push({\r\n            type: 'Attribute',\r\n            name,\r\n            value: valueNode,\r\n            start: attrStart,\r\n            end: attrStart + all.length,\r\n        });\r\n    }\r\n\r\n    return attrs;\r\n}\r\n","import { ParserOptions } from 'prettier';\r\nimport { Node } from '../print/nodes';\r\n\r\nexport function getText(node: Node, options: ParserOptions) {\r\n    return options.originalText.slice(options.locStart(node), options.locEnd(node));\r\n}\r\n","import { SupportOption } from 'prettier';\r\n\r\ndeclare module 'prettier' {\r\n    interface RequiredOptions extends PluginOptions {}\r\n}\r\n\r\nexport interface PluginOptions {\r\n    svelteSortOrder: SortOrder;\r\n    svelteStrictMode: boolean;\r\n    svelteBracketNewLine: boolean;\r\n}\r\n\r\nexport const options: Record<keyof PluginOptions, SupportOption> = {\r\n    svelteSortOrder: {\r\n        type: 'choice',\r\n        default: 'scripts-styles-markup',\r\n        description: 'Sort order for scripts, styles, and markup',\r\n        choices: [\r\n            { value: 'scripts-styles-markup' },\r\n            { value: 'scripts-markup-styles' },\r\n            { value: 'markup-styles-scripts' },\r\n            { value: 'markup-scripts-styles' },\r\n            { value: 'styles-markup-scripts' },\r\n            { value: 'styles-scripts-markup' },\r\n        ],\r\n    },\r\n    svelteStrictMode: {\r\n        type: 'boolean',\r\n        default: false,\r\n        description: 'More strict HTML syntax: self-closed tags, quotes in attributes',\r\n    },\r\n    svelteBracketNewLine: {\r\n        type: 'boolean',\r\n        default: false,\r\n        description: 'Put the `>` of a multiline element on a new line',\r\n    },\r\n};\r\n\r\nexport type SortOrder =\r\n    | 'scripts-styles-markup'\r\n    | 'scripts-markup-styles'\r\n    | 'markup-styles-scripts'\r\n    | 'markup-scripts-styles'\r\n    | 'styles-markup-scripts'\r\n    | 'styles-scripts-markup';\r\n\r\nexport type SortOrderPart = 'scripts' | 'markup' | 'styles';\r\n\r\nconst sortOrderSeparator = '-';\r\n\r\nexport function parseSortOrder(sortOrder: SortOrder): SortOrderPart[] {\r\n    return sortOrder.split(sortOrderSeparator) as SortOrderPart[];\r\n}\r\n","export function snipTagContent(tagName: string, source: string, placeholder = ''): string {\r\n    const regex = new RegExp(`[\\s\\n]*<${tagName}([^]*?)>([^]*?)<\\/${tagName}>[\\s\\n]*`, 'gi');\r\n    return source.replace(regex, (_, attributes, content) => {\r\n        const encodedContent = Buffer.from(content).toString('base64');\r\n        return `<${tagName}${attributes} ✂prettier:content✂=\"${encodedContent}\">${placeholder}</${tagName}>`;\r\n    });\r\n}\r\n\r\nexport function hasSnippedContent(text: string) {\r\n    return text.includes('✂prettier:content✂');\r\n}\r\n\r\nexport function unsnipContent(text: string): string {\r\n    const regex = /(<\\w+.*?)\\s*✂prettier:content✂=\"(.*?)\">.*?(?=<\\/)/gi\r\n    return text.replace(regex, (_, start, encodedContent) => {\r\n        const content = Buffer.from(encodedContent, 'base64').toString('utf8');\r\n        return `${start}>${content}`;\r\n    });\r\n    return text;\r\n}\r\n","import { FastPath, Doc, doc, ParserOptions } from 'prettier';\r\nimport { Node, MustacheTagNode, IfBlockNode, EachBlockNode } from './nodes';\r\nimport { isASTNode } from './helpers';\r\nimport { extractAttributes } from '../lib/extractAttributes';\r\nimport { getText } from '../lib/getText';\r\nimport { parseSortOrder, SortOrderPart } from '../options';\r\nimport { hasSnippedContent, unsnipContent } from '../lib/snipTagContent';\r\nconst {\r\n    concat,\r\n    join,\r\n    line,\r\n    group,\r\n    indent,\r\n    dedent,\r\n    softline,\r\n    hardline,\r\n    fill,\r\n    breakParent,\r\n} = doc.builders;\r\n\r\nexport type PrintFn = (path: FastPath) => Doc;\r\n\r\ndeclare module 'prettier' {\r\n    export namespace doc {\r\n        namespace builders {\r\n            interface Line {\r\n                keepIfLonely?: boolean;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// @see http://xahlee.info/js/html5_non-closing_tag.html\r\nconst SELF_CLOSING_TAGS = [\r\n    'area',\r\n    'base',\r\n    'br',\r\n    'col',\r\n    'embed',\r\n    'hr',\r\n    'img',\r\n    'input',\r\n    'link',\r\n    'meta',\r\n    'param',\r\n    'source',\r\n    'track',\r\n    'wbr',\r\n];\r\n\r\nexport function print(path: FastPath, options: ParserOptions, print: PrintFn): Doc {\r\n    const n = path.getValue();\r\n    if (!n) {\r\n        return '';\r\n    }\r\n\r\n    if (isASTNode(n)) {\r\n        const parts: doc.builders.Doc[] = [];\r\n        const addParts: Record<SortOrderPart, () => void> = {\r\n            scripts() {\r\n                if (n.module) {\r\n                    n.module.type = 'Script';\r\n                    n.module.attributes = extractAttributes(getText(n.module, options));\r\n                    parts.push(path.call(print, 'module'));\r\n                }\r\n                if (n.instance) {\r\n                    n.instance.type = 'Script';\r\n                    n.instance.attributes = extractAttributes(getText(n.instance, options));\r\n                    parts.push(path.call(print, 'instance'));\r\n                }\r\n            },\r\n            styles() {\r\n                if (n.css) {\r\n                    n.css.type = 'Style';\r\n                    n.css.content.type = 'StyleProgram';\r\n                    parts.push(path.call(print, 'css'));\r\n                }\r\n            },\r\n            markup() {\r\n                const htmlDoc = path.call(print, 'html');\r\n                if (htmlDoc) {\r\n                    parts.push(htmlDoc);\r\n                }\r\n            },\r\n        };\r\n        parseSortOrder(options.svelteSortOrder).forEach(p => addParts[p]());\r\n        return group(join(hardline, parts));\r\n    }\r\n\r\n    const [open, close] = options.svelteStrictMode ? ['\"{', '}\"'] : ['{', '}'];\r\n    const node = n as Node;\r\n    switch (node.type) {\r\n        case 'Fragment':\r\n            const children = node.children;\r\n\r\n            if (children.length === 0 || children.every(isEmptyNode)) {\r\n                return '';\r\n            }\r\n\r\n            return concat([printChildren(path, print, false), hardline]);\r\n        case 'Text':\r\n            if (isEmptyNode(node)) {\r\n                return {\r\n                    /**\r\n                     * Empty (whitespace-only) text nodes are collapsed into a single `line`,\r\n                     * which will be rendered as a single space if this node's group fits on a\r\n                     * single line. This follows how vanilla HTML is handled both by browsers and\r\n                     * by Prettier core.\r\n                     */\r\n                    ...line,\r\n\r\n                    /**\r\n                     * A text node is considered lonely if it is in a group without other inline\r\n                     * elements, such as the line breaks between otherwise consecutive HTML tags.\r\n                     * Text nodes that are both empty and lonely are discarded unless they have at\r\n                     * least one empty line (i.e. at least two linebreak sequences). This is to\r\n                     * allow for flexible grouping of HTML tags in a particular indentation level,\r\n                     * and is similar to how vanilla HTML is handled in Prettier core.\r\n                     */\r\n                    keepIfLonely: /\\n\\r?\\s*\\n\\r?/.test(node.raw || node.data),\r\n                };\r\n            }\r\n\r\n            /**\r\n             * For non-empty text nodes each sequence of non-whitespace characters (effectively,\r\n             * each \"word\") is joined by a single `line`, which will be rendered as a single space\r\n             * until this node's current line is out of room, at which `fill` will break at the\r\n             * most convienient instance of `line`.\r\n             */\r\n            return fill(join(line, (node.raw || node.data).split(/[\\t\\n\\f\\r ]+/)).parts);\r\n        case 'Element':\r\n        case 'InlineComponent':\r\n        case 'Slot':\r\n        case 'Window':\r\n        case 'Head':\r\n        case 'Title': {\r\n            const isEmpty = node.children.every(child => isEmptyNode(child));\r\n            const isSelfClosingTag =\r\n                isEmpty &&\r\n                (!options.svelteStrictMode ||\r\n                    node.type !== 'Element' ||\r\n                    SELF_CLOSING_TAGS.indexOf(node.name) !== -1);\r\n\r\n            return group(\r\n                concat([\r\n                    '<',\r\n                    node.name,\r\n\r\n                    indent(\r\n                        group(\r\n                            concat([\r\n                                node.type === 'InlineComponent' && node.expression\r\n                                    ? concat([\r\n                                          line,\r\n                                          'this=',\r\n                                          open,\r\n                                          printJS(path, print, 'expression'),\r\n                                          close,\r\n                                      ])\r\n                                    : '',\r\n                                ...path.map(childPath => childPath.call(print), 'attributes'),\r\n                                options.svelteBracketNewLine\r\n                                    ? dedent(isSelfClosingTag ? line : softline)\r\n                                    : '',\r\n                            ]),\r\n                        ),\r\n                    ),\r\n\r\n                    isSelfClosingTag ? `${options.svelteBracketNewLine ? '' : ' '}/>` : '>',\r\n\r\n                    isEmpty ? '' : indent(printChildren(path, print)),\r\n\r\n                    isSelfClosingTag ? '' : concat(['</', node.name, '>']),\r\n                ]),\r\n            );\r\n        }\r\n        case 'Options':\r\n        case 'Body':\r\n            return group(\r\n                concat([\r\n                    '<',\r\n                    node.name,\r\n\r\n                    indent(\r\n                        group(concat(path.map(childPath => childPath.call(print), 'attributes'))),\r\n                    ),\r\n\r\n                    ' />',\r\n                ]),\r\n            );\r\n        case 'Identifier':\r\n            return node.name;\r\n        case 'Attribute': {\r\n            const hasLoneMustacheTag =\r\n                node.value !== true &&\r\n                node.value.length === 1 &&\r\n                node.value[0].type === 'MustacheTag';\r\n            let isAttributeShorthand =\r\n                node.value !== true &&\r\n                node.value.length === 1 &&\r\n                node.value[0].type === 'AttributeShorthand';\r\n\r\n            // Convert a={a} into {a}\r\n            if (hasLoneMustacheTag) {\r\n                const expression = (node.value as [MustacheTagNode])[0].expression;\r\n                isAttributeShorthand =\r\n                    expression.type === 'Identifier' && expression.name === node.name;\r\n            }\r\n\r\n            if (isAttributeShorthand) {\r\n                return concat([line, '{', node.name, '}']);\r\n            }\r\n\r\n            const def: Doc[] = [line, node.name];\r\n            if (node.value !== true) {\r\n                def.push('=');\r\n                const quotes = !hasLoneMustacheTag || options.svelteStrictMode;\r\n\r\n                quotes && def.push('\"');\r\n                def.push(...path.map(childPath => childPath.call(print), 'value'));\r\n                quotes && def.push('\"');\r\n            }\r\n            return concat(def);\r\n        }\r\n        case 'MustacheTag':\r\n            return concat(['{', printJS(path, print, 'expression'), '}']);\r\n        case 'IfBlock': {\r\n            const def: Doc[] = [\r\n                '{#if ',\r\n                printJS(path, print, 'expression'),\r\n                '}',\r\n                indent(printChildren(path, print)),\r\n            ];\r\n\r\n            if (node.else) {\r\n                def.push(path.call(print, 'else'));\r\n            }\r\n\r\n            def.push('{/if}');\r\n\r\n            return group(concat(def));\r\n        }\r\n        case 'ElseBlock': {\r\n            // Else if\r\n            const parent = path.getParentNode() as Node;\r\n\r\n            if (\r\n                node.children.length === 1 &&\r\n                node.children[0].type === 'IfBlock' &&\r\n                parent.type !== 'EachBlock'\r\n            ) {\r\n                const ifNode = node.children[0] as IfBlockNode;\r\n                const def: Doc[] = [\r\n                    '{:else if ',\r\n                    path.map(ifPath => printJS(path, print, 'expression'), 'children')[0],\r\n                    '}',\r\n                    indent(path.map(ifPath => printChildren(ifPath, print), 'children')[0]),\r\n                ];\r\n\r\n                if (ifNode.else) {\r\n                    def.push(path.map(ifPath => ifPath.call(print, 'else'), 'children')[0]);\r\n                }\r\n                return group(concat(def));\r\n            }\r\n\r\n            return group(concat(['{:else}', indent(printChildren(path, print))]));\r\n        }\r\n        case 'EachBlock': {\r\n            const def: Doc[] = [\r\n                '{#each ',\r\n                printJS(path, print, 'expression'),\r\n                ' as ',\r\n                printJS(path, print, 'context'),\r\n            ];\r\n\r\n            if (node.index) {\r\n                def.push(', ', node.index);\r\n            }\r\n\r\n            if (node.key) {\r\n                def.push(' (', printJS(path, print, 'key'), ')');\r\n            }\r\n\r\n            def.push('}', indent(printChildren(path, print)));\r\n\r\n            if (node.else) {\r\n                def.push(path.call(print, 'else'));\r\n            }\r\n\r\n            def.push('{/each}');\r\n\r\n            return group(concat(def));\r\n        }\r\n        case 'AwaitBlock': {\r\n            const hasPendingBlock =\r\n                node.pending.children.length !== 0 && !node.pending.children.every(isEmptyNode);\r\n            const hasCatchBlock =\r\n                node.catch.children.length !== 0 && !node.catch.children.every(isEmptyNode);\r\n\r\n            if (hasPendingBlock && hasCatchBlock) {\r\n                return group(\r\n                    concat([\r\n                        group(concat(['{#await ', printJS(path, print, 'expression'), '}'])),\r\n                        indent(path.call(print, 'pending')),\r\n                        group(concat(['{:then', node.value ? ' ' + node.value : '', '}'])),\r\n                        indent(path.call(print, 'then')),\r\n                        group(concat(['{:catch', node.error ? ' ' + node.error : '', '}'])),\r\n                        indent(path.call(print, 'catch')),\r\n                        '{/await}',\r\n                    ]),\r\n                );\r\n            }\r\n\r\n            if (hasPendingBlock) {\r\n                return group(\r\n                    concat([\r\n                        group(concat(['{#await ', printJS(path, print, 'expression'), '}'])),\r\n                        indent(path.call(print, 'pending')),\r\n                        group(concat(['{:then', node.value ? ' ' + node.value : '', '}'])),\r\n                        indent(path.call(print, 'then')),\r\n                        '{/await}',\r\n                    ]),\r\n                );\r\n            }\r\n\r\n            return group(\r\n                concat([\r\n                    group(\r\n                        concat([\r\n                            '{#await ',\r\n                            printJS(path, print, 'expression'),\r\n                            ' then ',\r\n                            node.value ? node.value : '',\r\n                            '}',\r\n                        ]),\r\n                    ),\r\n                    indent(path.call(print, 'then')),\r\n                    '{/await}',\r\n                ]),\r\n            );\r\n        }\r\n        case 'ThenBlock':\r\n        case 'PendingBlock':\r\n        case 'CatchBlock':\r\n            return printChildren(path, print);\r\n        case 'EventHandler':\r\n            return concat([\r\n                line,\r\n                'on:',\r\n                node.name,\r\n                node.modifiers && node.modifiers.length\r\n                    ? concat(['|', join('|', node.modifiers)])\r\n                    : '',\r\n                node.expression\r\n                    ? concat(['=', open, printJS(path, print, 'expression'), close])\r\n                    : '',\r\n            ]);\r\n        case 'Binding':\r\n            return concat([\r\n                line,\r\n                'bind:',\r\n                node.name,\r\n                node.expression.type === 'Identifier' && node.expression.name === node.name\r\n                    ? ''\r\n                    : concat(['=', open, printJS(path, print, 'expression'), close]),\r\n            ]);\r\n        case 'Class':\r\n            return concat([\r\n                line,\r\n                'class:',\r\n                node.name,\r\n                node.expression.type === 'Identifier' && node.expression.name === node.name\r\n                    ? ''\r\n                    : concat(['=', open, printJS(path, print, 'expression'), close]),\r\n            ]);\r\n        case 'Let':\r\n            return concat([\r\n                line,\r\n                'let:',\r\n                node.name,\r\n                // shorthand let directives have `null` expressions\r\n                !node.expression ||\r\n                (node.expression.type === 'Identifier' && node.expression.name === node.name)\r\n                    ? ''\r\n                    : concat(['=', open, printJS(path, print, 'expression'), close]),\r\n            ]);\r\n        case 'DebugTag':\r\n            return concat([\r\n                '{@debug',\r\n                node.identifiers.length > 0\r\n                    ? concat([' ', join(', ', path.map(print, 'identifiers'))])\r\n                    : '',\r\n                '}',\r\n            ]);\r\n        case 'Ref':\r\n            return concat([line, 'ref:', node.name]);\r\n        case 'Comment': {\r\n            let text = node.data;\r\n            if (hasSnippedContent(text)) {\r\n                text = unsnipContent(text);\r\n            }\r\n\r\n            return group(concat(['<!--', text, '-->']));\r\n        }\r\n        case 'Transition':\r\n            const kind = node.intro && node.outro ? 'transition' : node.intro ? 'in' : 'out';\r\n            return concat([\r\n                line,\r\n                kind,\r\n                ':',\r\n                node.name,\r\n                node.modifiers && node.modifiers.length\r\n                    ? concat(['|', join('|', node.modifiers)])\r\n                    : '',\r\n                node.expression\r\n                    ? concat(['=', open, printJS(path, print, 'expression'), close])\r\n                    : '',\r\n            ]);\r\n        case 'Action':\r\n            return concat([\r\n                line,\r\n                'use:',\r\n                node.name,\r\n                node.expression\r\n                    ? concat(['=', open, printJS(path, print, 'expression'), close])\r\n                    : '',\r\n            ]);\r\n        case 'Animation':\r\n            return concat([\r\n                line,\r\n                'animate:',\r\n                node.name,\r\n                node.expression\r\n                    ? concat(['=', open, printJS(path, print, 'expression'), close])\r\n                    : '',\r\n            ]);\r\n        case 'RawMustacheTag':\r\n            return concat(['{@html ', printJS(path, print, 'expression'), '}']);\r\n        case 'Spread':\r\n            return concat([line, '{...', printJS(path, print, 'expression'), '}']);\r\n    }\r\n\r\n    console.log(JSON.stringify(node, null, 4));\r\n    throw new Error('unknown node type: ' + node.type);\r\n}\r\n\r\nfunction isEmptyGroup(group: Doc[]): boolean {\r\n    if (group.length === 0) {\r\n        return true;\r\n    }\r\n\r\n    if (group.length > 1) {\r\n        return false;\r\n    }\r\n\r\n    const lonelyDoc = group[0];\r\n\r\n    if (typeof lonelyDoc === 'string' || lonelyDoc.type !== 'line') {\r\n        return false;\r\n    }\r\n\r\n    return !lonelyDoc.keepIfLonely;\r\n}\r\n\r\n/**\r\n * Due to how `String.prototype.split` works, `TextNode`s with leading whitespace will be printed\r\n * to a `Fill` that has two additional parts at the begnning: an empty string (`''`) and a `line`.\r\n * If such a `Fill` doc is present at the beginning of an inline node group, those additional parts\r\n * need to be removed to prevent additional whitespace at the beginning of the parent's inner\r\n * content or after a sibling block node (i.e. HTML tags).\r\n */\r\nfunction trimLeft(group: Doc[]): void {\r\n    if (group.length === 0) {\r\n        return;\r\n    }\r\n\r\n    const first = group[0];\r\n    if (typeof first === 'string') {\r\n        return;\r\n    }\r\n\r\n    if (first.type === 'line') {\r\n        group.shift();\r\n        return;\r\n    }\r\n\r\n    if (first.type !== 'fill') {\r\n        return;\r\n    }\r\n\r\n    // find the index of the first part that isn't an empty string or a line\r\n    const trimIndex = first.parts.findIndex(part =>\r\n        typeof part === 'string' ? part !== '' : part.type !== 'line',\r\n    );\r\n\r\n    first.parts.splice(0, trimIndex);\r\n}\r\n\r\n/**\r\n * Due to how `String.prototype.split` works, `TextNode`s with trailing whitespace will be printed\r\n * to a `Fill` that has two additional parts at the end: a `line` and an empty string (`''`). If\r\n * such a `Fill` doc is present at the beginning of an inline node group, those additional parts\r\n * need to be removed to prevent additional whitespace at the end of the parent's inner content or\r\n * before a sibling block node (i.e. HTML tags).\r\n */\r\nfunction trimRight(group: Doc[]): void {\r\n    if (group.length === 0) {\r\n        return;\r\n    }\r\n\r\n    const last = group[group.length - 1];\r\n    if (typeof last === 'string') {\r\n        return;\r\n    }\r\n\r\n    if (last.type === 'line') {\r\n        group.pop();\r\n        return;\r\n    }\r\n\r\n    if (last.type !== 'fill') {\r\n        return;\r\n    }\r\n\r\n    last.parts.reverse();\r\n\r\n    // find the index of the first part that isn't an empty string or a line\r\n    const trimIndex = last.parts.findIndex(part =>\r\n        typeof part === 'string' ? part !== '' : part.type !== 'line',\r\n    );\r\n\r\n    last.parts.splice(0, trimIndex);\r\n    last.parts.reverse();\r\n}\r\n\r\nfunction printChildren(path: FastPath, print: PrintFn, surroundingLines = true): Doc {\r\n    const childDocs: Doc[] = [];\r\n    let currentGroup: Doc[] = [];\r\n\r\n    /**\r\n     * Sequences of inline nodes (currently, `TextNode`s and `MustacheTag`s) are collected into\r\n     * groups and printed as a single `Fill` doc so that linebreaks as a result of sibling block\r\n     * nodes (currently, all HTML elements) don't cause those inline sequences to break\r\n     * prematurely. This is particularly important for whitespace sensitivity, as it is often\r\n     * desired to have text directly wrapping a mustache tag without additional whitespace.\r\n     */\r\n    function flush() {\r\n        if (!isEmptyGroup(currentGroup)) {\r\n            trimLeft(currentGroup);\r\n            trimRight(currentGroup);\r\n            childDocs.push(fill(currentGroup));\r\n        }\r\n        currentGroup = [];\r\n    }\r\n\r\n    path.each(childPath => {\r\n        const childNode = childPath.getValue() as Node;\r\n        const childDoc = childPath.call(print);\r\n\r\n        if (isInlineNode(childNode)) {\r\n            currentGroup.push(childDoc);\r\n        } else {\r\n            flush();\r\n            childDocs.push(concat([breakParent, childDoc]));\r\n        }\r\n    }, 'children');\r\n\r\n    flush();\r\n\r\n    return concat([\r\n        surroundingLines ? softline : '',\r\n        join(hardline, childDocs),\r\n        surroundingLines ? dedent(softline) : '',\r\n    ]);\r\n}\r\n\r\nfunction printJS(path: FastPath, print: PrintFn, name?: string) {\r\n    if (!name) {\r\n        path.getValue().isJS = true;\r\n        return path.call(print);\r\n    }\r\n\r\n    path.getValue()[name].isJS = true;\r\n    return path.call(print, name);\r\n}\r\n\r\nfunction isInlineNode(node: Node): boolean {\r\n    return node.type === 'Text' || node.type === 'MustacheTag';\r\n}\r\n\r\nfunction isEmptyNode(node: Node): boolean {\r\n    return node.type === 'Text' && (node.raw || node.data).trim() === '';\r\n}\r\n","import { FastPath, Doc, doc, ParserOptions } from 'prettier';\r\nimport { PrintFn } from './print';\r\nimport { Node, AttributeNode, TextNode } from './print/nodes';\r\nimport { getText } from './lib/getText';\r\n\r\nconst {\r\n    builders: { concat, hardline, group, indent },\r\n    utils: { removeLines },\r\n} = doc;\r\n\r\nexport function embed(\r\n    path: FastPath,\r\n    print: PrintFn,\r\n    textToDoc: (text: string, options: object) => Doc,\r\n    options: ParserOptions,\r\n): Doc | null {\r\n    const node: Node = path.getNode();\r\n    if (node.isJS) {\r\n        return removeLines(\r\n            textToDoc(getText(node, options), {\r\n                parser: expressionParser,\r\n                singleQuote: true,\r\n            }),\r\n        );\r\n    }\r\n\r\n    switch (node.type) {\r\n        case 'Script':\r\n            return embedTag('script', path, print, textToDoc, node);\r\n        case 'Style':\r\n            return embedTag('style', path, print, textToDoc, node);\r\n        case 'Element': {\r\n            if (node.name === 'script' || node.name === 'style') {\r\n                return embedTag(node.name, path, print, textToDoc, node, true)\r\n            }\r\n        }\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\nfunction expressionParser(text: string, parsers: any) {\r\n    const ast = parsers.babylon(`(${text})`);\r\n    return {\r\n        type: 'File',\r\n        program: ast.program.body[0].expression,\r\n    };\r\n}\r\n\r\nfunction skipBlank(docs: Doc[]): number {\r\n    for (let i = docs.length - 1; i >= 0; i--) {\r\n        const doc = docs[i];\r\n        if (typeof doc !== 'string') {\r\n            if (doc.type === 'break-parent') {\r\n                continue;\r\n            }\r\n        }\r\n\r\n        return i;\r\n    }\r\n\r\n    return -1;\r\n}\r\n\r\nfunction nukeLastLine(doc: Doc): Doc {\r\n    if (typeof doc === 'string') {\r\n        return doc;\r\n    }\r\n\r\n    switch (doc.type) {\r\n        case 'concat':\r\n            const end = skipBlank(doc.parts);\r\n            if (end > -1) {\r\n                return concat([\r\n                    ...doc.parts.slice(0, end),\r\n                    nukeLastLine(doc.parts[end]),\r\n                    ...doc.parts.slice(end + 1),\r\n                ]);\r\n            }\r\n            break;\r\n        case 'line':\r\n            return '';\r\n    }\r\n\r\n    return doc;\r\n}\r\n\r\nfunction embedTag(\r\n    tag: string,\r\n    path: FastPath,\r\n    print: PrintFn,\r\n    textToDoc: (text: string, options: object) => Doc,\r\n    node: Node & { attributes: Node[] },\r\n    inline: boolean,\r\n) {\r\n    const parser = tag === 'script' ? 'typescript' : 'css';\r\n    const contentAttribute = (node.attributes as AttributeNode[]).find(\r\n        n => n.name === '✂prettier:content✂',\r\n    );\r\n    let content = '';\r\n    if (\r\n        contentAttribute &&\r\n        Array.isArray(contentAttribute.value) &&\r\n        contentAttribute.value.length > 0\r\n    ) {\r\n        const encodedContent = (contentAttribute.value[0] as TextNode).data;\r\n        content = Buffer.from(encodedContent, 'base64').toString('utf-8');\r\n    }\r\n    node.attributes = node.attributes.filter(n => n !== contentAttribute);\r\n\r\n    return group(\r\n        concat([\r\n            '<',\r\n            tag,\r\n            indent(group(concat(path.map(childPath => childPath.call(print), 'attributes')))),\r\n            '>',\r\n            indent(concat([hardline, nukeLastLine(textToDoc(content, { parser }))])),\r\n            hardline,\r\n            '</',\r\n            tag,\r\n            '>',\r\n            inline ? '' : hardline,\r\n        ]),\r\n    );\r\n}\r\n","import { SupportLanguage, Parser, Printer } from 'prettier';\r\nimport { print } from './print';\r\nimport { embed } from './embed';\r\nimport { snipTagContent } from './lib/snipTagContent';\r\n\r\nfunction locStart(node: any) {\r\n    return node.start;\r\n}\r\n\r\nfunction locEnd(node: any) {\r\n    return node.end;\r\n}\r\n\r\nexport const languages: Partial<SupportLanguage>[] = [\r\n    {\r\n        name: 'svelte',\r\n        parsers: ['svelte'],\r\n        extensions: ['.svelte'],\r\n    },\r\n];\r\n\r\nexport const parsers: Record<string, Parser> = {\r\n    svelte: {\r\n        parse: text => {\r\n            try {\r\n                return require(`svelte/compiler`).parse(text);\r\n            } catch (err) {\r\n                err.loc = {\r\n                    start: err.start,\r\n                    end: err.end,\r\n                };\r\n                delete err.start;\r\n                delete err.end;\r\n                throw err;\r\n            }\r\n        },\r\n        preprocess: text => {\r\n            text = snipTagContent('style', text);\r\n            text = snipTagContent('script', text, '{}');\r\n            return text.trim();\r\n        },\r\n        locStart,\r\n        locEnd,\r\n        astFormat: 'svelte-ast',\r\n    },\r\n};\r\n\r\nexport const printers: Record<string, Printer> = {\r\n    'svelte-ast': {\r\n        print,\r\n        embed,\r\n    },\r\n};\r\n\r\nexport { options } from './options';\r\n"],"names":["doc","options","concat","hardline","group","indent"],"mappings":"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"}